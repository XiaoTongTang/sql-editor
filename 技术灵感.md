# 技术灵感

记录一些实现过程中想到的解决某问题的灵感

## 实现撤回，重做，复制，黏贴功能

灵感时间版本：20251227 8：58 v1

目标：

- 我想做的撤回，重做，复制，黏贴功能是像一个真正编辑器那样，而不是平常干活时写的普通web表单

分析：

- 所以，撤回，复制，黏贴的操作应该是“编辑器全局”的，不应该局限在某个子组件内部。
- 但我目前的代码中，一行insert语句是由一个完整的 InsUpdSqlEditTable组件 实现，内部操作不暴露给外部。
- 但是作为vue项目不可能舍弃组件化思路
- 所以设计了如下的设计原则：
  1. 此项目中的所有“组件”，比如 InsUpdSqlEditTable组件 都只展示GUI，不包含任何 “编辑操作” 逻辑
  2. 将所有 “被编辑的数据” 提升到全局，用PINIA管理
  3. 其次，引入一个 “编辑坐标” 概念。此编辑坐标表示的是编辑器全局的编辑位置，用于标识每一次编辑发生在哪一颗语法树，乃至哪一个语法树节点。
  4. 最后，将所有编辑操作都转换为 “编辑坐标” + “操作入参” 的格式
  5. 将所有编辑操作都转换为 “编辑坐标” + “操作入参” 的格式
  6. 将所有 编辑操作 暴露到全局，供所有组件调用
  7. 每个组件的编辑操作，都是调用全局的编辑操作函数，只是传入的编辑坐标不同。
- 基于上面的 “全局编辑” 原则，再实现操作栈（实现撤回重做功能）（操作栈每次入栈的是 ‘编辑坐标’ + ‘操作入参’ + 操作名称），以及“复制黏贴”功能（可能复制黏贴功能是将 ‘选中的坐标’ 复制到 ‘黏贴坐标’ 处）
